var _hash=new Object();var chartObject=new Object();var reportData=new Object();var dataToSave=new Array();var tableData=new Object();var tableNotSave=new Array();var sortTypeData=new Object();var sortTypeArray=new Array();var matrixToSave=new Array();var matrixArray=new Object();var isDownloading=false;var filterJump=true;var filterEmpty=false;var displayTableTiao=true;var isSaving=false;var use2d=1;function getExpDate(d,a,c){var b=new Date();if(typeof(d)=="number"&&typeof(a)=="number"&&typeof(a)=="number"){b.setDate(b.getDate()+parseInt(d));b.setHours(b.getHours()+parseInt(a));b.setMinutes(b.getMinutes()+parseInt(c));return b.toGMTString();}}function getCookieVal(b){var a=document.cookie.indexOf(";",b);if(a==-1){a=document.cookie.length;}return unescape(document.cookie.substring(b,a));}function getCookie(d){var b=d+"=";var f=b.length;var a=document.cookie.length;var e=0;while(e<a){var c=e+f;if(document.cookie.substring(e,c)==b){return getCookieVal(c);}e=document.cookie.indexOf(" ",e)+1;if(e==0){break;}}return"";}function setCookie(b,d,a,f,c,e){document.cookie=b+"="+escape(d)+((a)?"; expires="+a:"")+((f)?"; path="+f:"")+((c)?"; domain="+c:"")+((e)?"; secure":"");}function ReportItem(){this.qIndex=10000;this.type=1;this.data="";this.usePercent=true;this.width=400;this.height=350;this.matrix=false;this.HasSort=0;}var chartHeader="<chart caption='' palette='2' showFCMenuItem='0'  imageSave='1' imageSaveURL='/wjx/ActivityStat/FusionChartSave.aspx?activityId="+activityId+"' animation='1' baseFontSize ='12' bgColor='eeeeee,FFFFFF' borderColor='1D8BD1' borderThickness='1' borderAlpha='50' bgAlpha='30' showBorder='1' subCaption=''    {0} formatNumberScale='0'  pieYScale='48' enableSmartLabels='1'  manageLabelOverflow='1'>";var chartTrailer="<styles><definition><style type='font' name='CaptionFont' color='666666' size='15' /><style type='font' name='SubCaptionFont' bold='0' /></definition><application><apply toObject='caption' styles='CaptionFont' /><apply toObject='SubCaption' styles='SubCaptionFont' /></application></styles></chart>";var imgDomain="";function swapObj(c,b){var a=c;c=b;b=a;}function GetChartData(a,t,b){var B=chartHeader;var v=0;var l="";var o=false;var g=true;var p=a+b;if(chartObject[a]&&chartObject[a].removeEmpty){o=true;}if(matrixData[a]){var r=Number(a.substring(1));var y=matrixData[a];var A="c"+(r+1);if(!matrixData[p]||!matrixData[p].daoZhi){l+=" <categories>";for(v=0;v<y.length;v++){l+="<category label='"+y[v]+"' />";}l+=" </categories>";var z=1;var e=chartData[A];var x=e.length;for(v=0;v<x;v++){l+="<dataset seriesName='"+e[v][0]+"'>";for(u=0;u<y.length;u++){A="c"+(r+u+1);var s=chartData[A][v][2]||chartData[A][v][1];if(chartData[A][v][2]==undefined){g=false;}l+="<set value='"+s+"' />";}l+="</dataset>";z++;}}else{l+=" <categories>";for(v=0;v<chartData[A].length;v++){l+="<category label='"+chartData[A][v][0]+"' />";}l+=" </categories>";var z=1;for(v=0;v<y.length;v++){l+="<dataset seriesName='"+y[v]+"'>";A="c"+(r+z);for(u=0;u<chartData[A].length;u++){var s=chartData[A][u][2]||chartData[A][u][1];if(chartData[A][u][2]==undefined){g=false;}l+="<set value='"+s+"' />";}l+="</dataset>";z++;}}}else{var C=chartData[a].length;var h=chartObject[a]?chartObject[a].sortType:0;if(h){for(v=C-1;v>0;--v){for(var u=0;u<v;++u){var n=chartData[a][u];var f=chartData[a][u+1];if(h==1&&n[1]<f[1]){var c=chartData[a][u];chartData[a][u]=chartData[a][u+1];chartData[a][u+1]=c;}else{if(h==2&&n[1]>f[1]){var c=chartData[a][u];chartData[a][u]=chartData[a][u+1];chartData[a][u+1]=c;}}}}}for(v=0;v<chartData[a].length;v++){if(chartData[a][v][1]<1&&o){continue;}var w="";var k="";var s=chartData[a][v][1];if(chartData[a][v].length==3){w=" toolText='"+chartData[a][v][0]+"( "+chartData[a][v][2]+"%25,"+chartData[a][v][1]+")' ";s=chartData[a][v][2];if(b==1){k=" displayValue='"+chartData[a][v][0]+"("+chartData[a][v][2]+"%25)' ";}}else{g=false;}l+="<set label='"+chartData[a][v][0]+"' value='"+s+"' "+w+k+" />";}}B=B+l;B=B+chartTrailer;var m="";if(g){m=" yAxisMaxValue='100' numberSuffix='%25' ";}B=B.replace("{0}",m);if(t){return{data:l,usePercent:g};}else{return{data:B,usePercent:g};}}var downloadWindow=null;function openwindow(b,a,d,h,c){var f=(window.screen.availHeight-30-h)/2;var e=(window.screen.availWidth-10-d)/2;var g="height="+h+",innerHeight="+h+",width="+d+",innerWidth="+d+",top="+f+",left="+e+",border=no,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,status=no";if(!c){PDF_launch(b,d,h,null,"下载调查报告");}else{downloadWindow=window.open(b+"&dt=1",a,g);downloadWindow.focus();}}if(window.spanbdshare){spanbdshare.onclick=function(){var a="hasShareBd";setCookie(a,"1",getExpDate(30,0,0),"/","sojump.com",null);PDF_close();};}function shareWjx(c){var e="hasShareBd";var b=getCookie(e);b=1;if(window.needShare&&!b){var a=document.getElementById("spanAction");var d="下载";if(c==1){d="分类统计";}else{if(c==2){d="交叉分析";}else{if(c==3){d="自定义查询";}}}a.innerHTML=d;PDF_launch(divShare,510,160);return false;}return true;}function GenerateReport(){if(!shareWjx()){return;}if(window.NeedSamplePay){samplePay();return;}dataToSave=new Array();var a=0;for(var f in reportData){var e=reportData[f].qIndex;if(e%10000>0){var h=e-e%10000;if(matrixArray[h+""]){var g=matrixArray[h+""];var j=document.getElementById(g);if(j.style.display!=""){continue;}}else{continue;}}dataToSave[a]=reportData[f];var c=GetChartData(f.substring(0,f.length-1),true,reportData[f].type);dataToSave[a].data=c.data;dataToSave[a].usePercent=c.usePercent;a++;}a=0;dataToSave.sort(function(k,d){return k.qIndex-d.qIndex;});tableNotSave=new Array();for(var f in tableData){tableNotSave[a]=f;a++;}a=0;matrixToSave=new Array();for(var f in matrixArray){matrixToSave[a]=f;a++;}a=0;for(var f in sortTypeData){sortTypeArray[a]=f+";"+sortTypeData[f];a++;}isDownloading=true;var b=cbFilter.getElementsByTagName("input");if(b){filterEmpty=b[0].checked;filterJump=b[1].checked;}displayTableTiao=document.getElementById("displayTableTiao").checked;openwindow("/wjx/activitystat/SaveChart.aspx?activity="+activityId+"&reportid="+reportId+"&use2d="+use2d,"生成报告",860,600);}function hideZero(a,c,j,h,f){if(!chartObject[j]){chartObject[j]=new Object();}chartObject[j].removeEmpty=chartObject[j].removeEmpty?false:true;f.innerHTML=chartObject[j].removeEmpty?"显示零数据":"隐藏零数据";var g=f.parentNode.parentNode.parentNode.parentNode.parentNode;var b=g.getElementsByTagName("table")[0].tBodies[0];var k=b.rows;for(i=0;i<k.length;i++){var e=k[i].cells[1].innerHTML;if(e=="0"){k[i].style.display=chartObject[j].removeEmpty?"none":"";}}}function showChart(a,d,l,h,e,m){var j=document.getElementById(a);var g;if(e==1){g=document.getElementById("displayBin");}if(e==2){g=document.getElementById("displayBar");}if(e==3){g=document.getElementById("displayZhe");}if(e==4){g=document.getElementById("displayTiao");}if(h==1){j.style.display=j.style.display==""?"none":"";}else{j.style.display=g.checked?"":"none";}var f=j.style.display=="";if(m&&m.parentNode){m.parentNode.className=f?"liSelect":"";}var b=400;var k=350;if(matrixData[l]){b=650;k=400;}displayChart(l,d,e,b,k,false,f);}function setReportData(h,f,e,a,g){var c=h+f;var d=false;if(matrixData[h]){d=true;}if(!g){delete reportData[c];}else{var b=reportData[c];if(b){b.width=e;b.height=a;}else{b=new ReportItem();b.qIndex=Number(h.substring(1));b.type=f;b.data="";b.width=e;b.height=a;b.matrix=d;reportData[c]=b;}}}function displayChart(o,d,f,b,n,h,k){var e;var m=o+f;var l=false;if(matrixData[o]){l=true;}setReportData(o,f,b,n,k);if(!_hash[m]){_hash[m]=m;}else{if(!h&&!chartObject[d]){return;}}var a="Pie3D.swf";if(use2d){a="Pie2D.swf";}if(!l){if(f==1){e=new FusionCharts(imgDomain+"/Images/wjx/viewstat/"+a,m,b,n,"0","1");}else{if(f==2){e=new FusionCharts(imgDomain+"/Images/wjx/viewstat/Column3D.swf",m,b,n,"0","1");}else{if(f==3){e=new FusionCharts(imgDomain+"/Images/wjx/viewstat/line.swf",m,b,n,"0","1");}else{if(f==4){e=new FusionCharts(imgDomain+"/Images/wjx/viewstat/bar2d.swf",m,b,n,"0","1");}}}}}else{if(f==2){e=new FusionCharts(imgDomain+"/Images/wjx/viewstat/MSColumn3D.swf",m,b,n,"0","1");}else{if(f==3){e=new FusionCharts(imgDomain+"/Images/wjx/viewstat/Msline.swf",m,b,n,"0","1");}else{if(f==4){e=new FusionCharts(imgDomain+"/Images/wjx/viewstat/Msbar3d.swf",m,b,n,"0","1");}}}}var g=GetChartData(o,false,f);e.setDataXML(g.data);e.render(d);var j=document.getElementById(d).parentNode;var c=j.parentNode.firstChild;if(c.nodeType==3){c=c.nextSibling;}if(c!=j){j.parentNode.insertBefore(j,c);}}function chartChange(g,h){var e=g.parentNode.parentNode.parentNode;var d=e.getElementsByTagName("div");for(var b=0;b<d.length;b++){for(var c=2;c<=4;c++){if(d[b].id.indexOf("chartDiv"+c)>-1&&d[b].id.indexOf("chartDiv"+c+"Con")==-1&&d[b].style.display!="none"){var a=h+c;if(arrayData[a]){width=arrayData[a][0];height=arrayData[a][1];}else{width=400;height=350;}var f=d[b].parentNode.style.display!="none";displayChart(h,d[b],c,width,height,true,f);}}}}function showTable(b,a,d,e){var g=document.getElementById(a);var f=document.getElementById("displayTable");if(d==1){g.style.display=g.style.display==""?"none":"";}else{g.style.display=f.checked?"":"none";}if(tableData[b]){delete tableData[b];}else{tableData[b]=b;}if(e&&e.parentNode){e.parentNode.className=g.style.display=="none"?"":"liSelect";}}var arrayData=new Array();function daozhiChart(c,f,e){var d=650;var a=400;var b=f+e;if(!matrixData[b]){matrixData[b]=new Object();}matrixData[b].daoZhi=!matrixData[b].daoZhi;if(arrayData[b]){d=arrayData[b][0];a=arrayData[b][1];}displayChart(f,c,e,d,a,true,true);}function enlargeChart(c,g,f,e){var d=400;var a=350;var b=g+f;if(arrayData[b]){d=arrayData[b][0];a=arrayData[b][1];}else{arrayData[b]=new Array();}if(e){d=d*5/4;a=a*5/4;}else{d=d*4/5;a=a*4/5;}arrayData[b][0]=d;arrayData[b][1]=a;displayChart(g,c,f,d,a,true,true);}function saveChart(c,e,d){if(window.FusionChartSave==0){alert("由于系统升级，暂时不能保存图片，您可以通过“截图工具”将图片截图！");return;}if(isSaving){alert("请等待前一个图片保存完成以后再保存");return;}isSaving=true;var b=e+d;var a=getChartFromId(b);a.saveAsImage();setTimeout(FC_Exported,10000);}function FC_Exported(a){isSaving=false;}function printChart(c,e,d){var b=e+d;var a=getChartFromId(b);a.print();}function Display(h){if(h.name=="displayBin"){processDiv(1,h);}else{if(h.name=="displayBar"){processDiv(2,h);}else{if(h.name=="displayZhe"){processDiv(3,h);}else{if(h.name=="displayTiao"){processDiv(4,h);}else{if(h.name=="displayTable"){var m=document.getElementById("ulList").getElementsByTagName("table");for(var f=0;f<m.length;f++){if(m[f].id.indexOf("tbItemCounter")>-1){var n=m[f];var c=n.id.replace("_tbItemCounter","")+"_chartDivData";var g=document.getElementById(c);if(!g){continue;}showTable(g.innerHTML,n.id,0);}}}else{if(h.name=="displayTableTiao"){var m=document.getElementById("ulList").getElementsByTagName("table");for(var f=0;f<m.length;f++){if(m[f].id.indexOf("tbItemCounter")>-1){var n=m[f];var o=n.getElementsByTagName("div");for(var b=0;b<o.length;b++){if(o[b].className!="bar"){continue;}o[b].style.display=o[b].style.display=="none"?"":"none";o[b].parentNode.align=o[b].style.display=="none"?"center":"";}}}}else{if(h.name=="displayValue"){var a=document.getElementById("ulList").getElementsByTagName("span");for(var d=0;d<a.length;d++){if(a[d].id.indexOf("lblValue")>-1){var l=document.getElementById(a[d].id);l.style.display=l.style.display==""?"none":"";}}var e=document.getElementById("lblValueTotal");if(e==null){return;}e.style.display=e.style.display==""?"none":"";}}}}}}}}function processDiv(l,k){var h=document.getElementById("ulList").getElementsByTagName("div");var f=1;for(var g=0;g<h.length;g++){if(h[g].id.indexOf("chartDiv"+l)>-1&&h[g].id.indexOf("chartDiv"+l+"Con")==-1){var b=h[g].id;var e=h[g].id+"Con";var d=h[g].id.substring(0,h[g].id.length-1)+"Data";document.getElementById(e).style.display="";var m="c"+document.getElementById(d).innerHTML;var a='showChart("'+e+'","'+b+'","'+m+'",0,'+l+")";setReportData(m,l,400,350,k.checked);if(!k.checked){document.getElementById(e).style.display="none";}else{setTimeout(a,1000*f);f+=1;}}}}function ShowMatrix(a,e,b,d){var c=document.getElementById(a);c.style.display=c.style.display=="none"?"":"none";d.innerHTML=c.style.display=="none"?"查看详细数据":"查看总体数据";var f=document.getElementById(b);f.style.display=f.style.display=="none"?"":"none";if(matrixArray[e]){delete matrixArray[e];}else{matrixArray[e]=a;}}window.onbeforeunload=function(){if(downloadWindow){try{if(downloadWindow.current){return("正在生成调查报告，关闭此窗口后，将不能正确生成，确定关闭吗？");}}catch(a){}}};var idArray=ids.split(",");for(var jj=0;jj<idArray.length;jj++){if(idArray[jj]!=""){var func=document.getElementById(idArray[jj]).href;setTimeout(func,200);}}window.onload=function(){var d=document.getElementById("ulList").getElementsByTagName("table");for(var c=0;c<d.length;c++){if(d[c].id.indexOf("tbItemCounter")>-1){var b=d[c];var f=b.tHead.rows[0];f.chartId=b.getAttribute("chartId");f.cells[0].parentTable=f.cells[1].parentTable=b;f.cells[0].onclick=f.cells[1].onclick=function(){var h=this.getElementsByTagName("img")[0];if(h){if(h.src.toLowerCase().indexOf("arrownone.gif")>-1){h.src="/images/wjx/viewstat/arrowdown.gif";}else{if(h.src.toLowerCase().indexOf("arrowdown.gif")>-1){h.src="/images/wjx/viewstat/arrowup.gif";h.alt="↑";}else{h.src="/images/wjx/viewstat/arrowdown.gif";h.alt="↓";}}}var j=this.parentNode.chartId;if(!j){return;}if(!chartObject[j]){chartObject[j]=new Object();}if(this.cellIndex==0){chartObject[j].sortType=0;}else{var k=chartObject[this.parentNode.chartId].sortType;if(!k){k=1;}else{if(k==1){k=2;}else{k=1;}}chartObject[j].sortType=k;}var g=Number(j.substring(1));if(!k){delete sortTypeData[g];}else{sortTypeData[g]=k;}sortTable(this.parentTable.tBodies[0],this.cellIndex,true);chartChange(this.parentTable,j);};}}var a=document.getElementById("lblValueTotal");if(a==null){document.getElementById("displayValue").parentNode.style.display="none";}var e=document.getElementById(firstId);if(e&&window.hideU){e.onclick();}};